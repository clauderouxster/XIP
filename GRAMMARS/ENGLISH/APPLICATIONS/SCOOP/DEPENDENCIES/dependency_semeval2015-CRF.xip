DependencyRules:


// some correction modifications


if (SENTIMENT[negative](#1[lemme:"worth"],#2[price]) & SENTIMENT(#3,#1) )
        SENTIMENT[negative=+](#3,#2)

if (SENTIMENT[positive](#1[lemme:"worth"],#2[price]) & SENTIMENT(#3,#1) )
        SENTIMENT[positive=+](#3,#2)

if (MOD(#1[cop],#2[lemme:"line"])  & PREPD(#2,#3[lemme:"in"]) & SUBJ(#1,#4[price]))
   SENTIMENT[positive=+](#4,#2)

if (ATTRIB(#1[food],#2[lemme:"companion"]))
   SENTIMENT[neutral=+](#1,#2)

if (^SENTIMENT[!sentiments:!](#1[style],#2) & MOD[post](#1,#3[food]))
   SENTIMENT(#3,#1)

|NFV#{?*,#2[last]}|
    if ( ( SUBJ-N(#2,#1) | OBJ-N(#2,#1)) &  ^SENTIMENT[sentiments:!](#2,#3[adv]) )
    SENTIMENT(#1,#2)



|#1[mwe]{?*,#2,?*}|
        if (^SENTIMENT(#2))
        ~

|#1[food,not-term=+]|
    if (OBJ-N(#2[service],#1) )
    ~

|#1[food,not-term=+]|
    if (MOD[post](#2[service],#1))
    ~

|#1[mwe]{?*,#2,?*}|
        if (^SENTIMENT(#2))
        ~

|#1[food,not-term=+]|
    if (OBJ-N(#2[service],#1) )
    ~

|#1[food,not-term=+]|
    if (MOD[post](#2[service],#1))
    ~

|NOUN#1[resto=+]{NOUN[resto],?*}|
        ~
        
///*********** FINAL EXTRACTIONS***********************
|NOUN#1{?*,?[locat]}|
       LOCATNP(#1)

|#3[locat]|
      if ( MOTHER(#3,#4) & ~LOCATNP(#4) ) 
        LOCATION(#3)

|NOUN#1{?*,?[food]}|
       FOODNP(#1)

|#3[food]|
      if ( MOTHER(#3,#4) & ~FOODNP(#4) ) 
        FOOD(#3)

|NOUN#1{?*,?[price]}|
       PRICENP(#1)

|#3[price]|
       if ( MOTHER(#3,#4)  & ~PRICENP(#4) ) 
        PRICE(#3)

|NOUN#1{?*,?[style]}|
       STYLENP(#1)

|NOUN#3[style]|
       if ( MOTHER(#3,#4)  & ~STYLENP(#4) ) 
        STYLE(#3)


|NOUN#1{?*,?[service]}|
       SERVICENP(#1)

|#3[service]|
  if ( MOTHER(#3,#4)  & ~SERVICENP(#4) ) 
        SERVICE(#3)

|NOUN#1{?*,?[ambience]}|
       AMBIENCENP(#1)

|#3[ambience]|
        if ( MOTHER(#3,#4)  & ~AMBIENCENP(#4) ) 
        AMBIENCE(#3)

// LOCATION

|#1[locat=+]{?*,#2[locat,last]}|
        if (^AMBIENCE(#1))
        LOCATION(#1)

|#1[locat=+]{#2[locat,first],?*[ambience:~]}|
        if (^AMBIENCE(#1))
        LOCATION(#1)

|#1[locat]|
        if (^AMBIENCE(#1) & ~LOCATION(#1))
        LOCATION(#1)

// DRINKS : 
|#1[drink=+]{?*,#2[drink,last]}|
        if (FOOD(#1))
        DRINK(#1)

|#1[drink=+]{#2[drink,first],?*[food:~]}|
        if (FOOD(#1))
        DRINK(#1)

|#1[drink]|
        if (FOOD(#1) & ~DRINK(#1))
        DRINK(#1)

if (^FOOD(#1) & DRINK(#1))   ~

|NOUN#1{?*,?[resto]}|
       RESTONP(#1)


|#3[resto,fromcrf]|
        if ( MOTHER(#3,#4) & ~RESTONP(#4) ) 
        RESTO(#3)

|?#1[noun,not-term:~,fromcrf,target=+]|
    if (FOOD(#1) & ~DRINK(#1) )
    ASPECTTERM[food=+](#1)

|?#1[noun,not-term:~,fromcrf,target=+]|
    if (DRINK(#1) )
    ASPECTTERM[drink=+](#1)

|?#1[noun,not-term:~,fromcrf,target=+]|
    if (AMBIENCE(#1) )
    ASPECTTERM[ambience=+](#1)

|?#1[noun,not-term:~,fromcrf,target=+]|
    if (SERVICE(#1) )
    ASPECTTERM[service=+](#1)

|?#1[noun,not-term:~,fromcrf,target=+]|
    if (RESTO(#1) )
    ASPECTTERM[resto=+](#1)

|?#1[noun,not-term:~,fromcrf,target=+]|
    if (LOCATION(#1) )
    ASPECTTERM[locat=+](#1)

if (  ASPECTTERM(#1) &  ^ASPECTTERM(#2) &  MOTHER(#2,#1) )
   ~

//the target percolates on the SC


|AP[positive=+]{?*,#1[positive],?*}|
    ~
|AP[negative=+]{?*,#1[negative],?*}|
    ~

|NP[target=+]{?*,?[target],?*}|
    ~
|PP[target=+]{?*,?[target],?*}|
    ~

|SC[target=+]{?*,NP[target=+]{?*,#1[target],?*},?*}|
    ~

|?#1{?*[prep:~],#2[last]}|
    if ( ASPECTTERM(#1) & ~TERMHEAD(#2,#1))
    TERMHEAD(#2,#1)

|?#1{#2[first],?*,?[prep]}|
    if ( ASPECTTERM(#1) & ~TERMHEAD(#2,#1))
    TERMHEAD(#2,#1)

if (PRICE(#1[noun]) )
    PSEUDOTERM[price=+](#1)

if (STYLE(#1[noun]) & ~DRINK(#1)  & ~FOOD(#1))
    PSEUDOTERM[style=+](#1)

if ( ASPECTTERM[!aspect:!](#1)  )
    PSEUDOTERM(#1)


|TOP#2[punct:~]| 
if (~FOOD(?) &  ~AMBIENCE(?) &  ~SERVICE(?) &  ~LOCATION(?) & ~HEAD(?[resto],?) & HEAD(?,?))
   NOTERM(#2)


//****DEPENDENCY PROPAGATION FOR SENTIMENTS********

if ( COREFLINK(#5,#3) & ASPECTTERM(#3) & SENTIMENT[!sentiments:!](#2,#5) )
   SENTIMENT(#2,#3)

if ( COREFLINK(#5,#3) & ASPECTTERM(#3) & SENTIMENT[!sentiments:!](#5,#2) )
   SENTIMENT(#3,#2)


//************LINKS POSTS AND PRE *********************

//|SC{?*,NP#1},?*[target:~,condclause:~],#3[target:~,attribs,!attribs:!,!sentiments:!],?*|
  //  if ( HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3)  ) 
//    LINKPOST(#2,#3)

|SC{?*,PP{?*,NP#1}},?*[target:~,condclause:~],#3[target:~,attribs,!attribs:!,!sentiments:!],?*|
    if ( HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3)  ) 
    LINKPOST(#2,#3)

|?*,NP#1,?*[target:~,condclause:~],#3[target:~,attribs,!attribs:!,!sentiments:!],?*|
    if (   HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3)  ) 
    LINKPOST(#2,#3)

|?*,PP{?*,NP#1},?*[target:~,condclause:~],#3[target:~,attribs,!attribs:!,!sentiments:!],?*|
    if (   HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3)  ) 
    LINKPOST(#2,#3)

//verb on sentiments  ?
|SC{?*,NP#1},?*[target:~,condclause:~],#3[target:~,sentiments,!sentiments:!,!attribs:!],?*|
    if (   HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3) ) 
    LINKPOST(#2,#3)
|SC{?*,PP{?*,NP#1}},?*[target:~,condclause:~],#3[target:~,sentiments,!sentiments:!,!attribs:!],?*|
    if (   HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3) ) 
    LINKPOST(#2,#3)

|?*,NP#1,?*[target:~,condclause:~],#3[target:~,sentiments,!sentiments:!,!attribs:!],?*|
    if (  HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3)  ) 
    LINKPOST(#2,#3)

|?*,PP{?*,NP#1},?*[target:~,condclause:~],#3[target:~,sentiments,!sentiments:!,!attribs:!],?*|
    if (  HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3)  ) 
    LINKPOST(#2,#3)



|SC{?*,NP#1},?*[target:~,condclause:~],#3[target:~,sentiments,!sentiments:!,!attribs:!],?*[target:~]|
    if (   HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3) ) 
    LINKPOST(#2,#3)

|SC{?*,PP{?*,NP#1}},?*[target:~,condclause:~],#3[target:~,sentiments,!sentiments:!,!attribs:!],?*[target:~]|
    if (   HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3) ) 
    LINKPOST(#2,#3)

|?*,NP#1,?*[target:~,condclause:~],#3[target:~,sentiments,!sentiments:!,!attribs:!],?*[target:~]|
    if (  HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3)  ) 
    LINKPOST(#2,#3)

|?*,PP{?*,NP#1},?*[target:~,condclause:~],#3[target:~,sentiments,!sentiments:!,!attribs:!],?*[target:~]|
    if (  HEAD(#2,#1) & PSEUDOTERM[!aspect:!](#2[!attribs:!]) & ~LINKPOST(#2,#3)  ) 
    LINKPOST(#2,#3)



 |SC{?*,FV[!attribs:!]{?*,#1[last]}},NP#2[target],?*[sentiments:~,aspect:~,target:~,attribs:~],NP#4[!attribs:!,!aspect:!,target],?*[sentiments:~]|
     if ( MAIN(#1) & HEAD(#3,#2) & HEAD(#5,#4) & SENTIMENT[!sentiments:!](#3,#1) & ~SENTIMENT(#5,?) )
      LINKPRE(#1,#4)

 |SC{?*,FV[!attribs:!]{?*,#1[last]}},NP#2[target],?*[sentiments:~,aspect:~,target:~,attribs:~],NP#4[!attribs:!,!aspect:!,target],?*[sentiments:~,aspect:~,target:~,attribs:~],NP#6[target,!attribs:!,!aspect:!],?*[sentiments:~,aspect:~,target:~,attribs:~]|
     if ( MAIN(#1) & HEAD(#3,#2) & HEAD(#5,#4) & SENTIMENT[!sentiments:!](#3,#1) & ~SENTIMENT(#5,?) & HEAD(#7,#4) & ~SENTIMENT(#7,?) )
      LINKPRE(#1,#4),LINKPRE(#1,#7)

if (SENTIMENT[!sentiments:!](#1) & ASPECTTERM[!aspect:!,!attribs:!](#2)  & ~SENTIMENT(#2,#3) & #1 < #2 & ~LINKPOST(#1,?) )
    LINKPRE(#1,#2) 

//** negations 

if ( ^LINKPOST[positive,!aspect:!,attribs:!,modified:~](#1,#3) & ( NEGAT(#2) | ATTRIB[neg](#1,#2))  & HEAD(#2,#3) )
     LINKPOST[negative=+,positive=~,modified=+](#1,#3)

if ( ^LINKPOST[negative,!aspect:!,attribs:!,modified:~](#1,#3) & ( NEGAT(#2)| ATTRIB[neg](#1,#2)) & HEAD(#2,#3) )
     LINKPOST[positive=+,negative=~,modified=+](#1,#3)

|#3{?*,#2[last,verb]}|
if ( ^LINKPOST[positive,!aspect:!,attribs:!,modified:~](#1,#3) & ( NEGAT(#2) | ATTRIB[neg](#1,#2))   )
     LINKPOST[negative=+,positive=~,modified=+](#1,#3)

|#3{?*,#2[last,verb]}|
if ( ^LINKPOST[negative,!aspect:!,attribs:!,modified:~](#1,#3) & ( NEGAT(#2)| ATTRIB[neg](#1,#2))  )
     LINKPOST[positive=+,negative=~,modified=+](#1,#3)

    
if ( ^LINKPRE[positive,!aspect:!,attribs:!,modified:~](#1,#3) & ( NEGAT(#2) | ATTRIB[neg](#1,#2)) & HEAD(#2,#3) )
     LINKPRE[negative=+,positive=~,modified=+](#1,#3)

if ( ^LINKPRE[negative,!aspect:!,attribs:!,modified:~](#1,#3) & ( NEGAT(#2) | ATTRIB[neg](#1,#2)) & HEAD(#2,#3) )
     LINKPRE[negative=~,positive=+,modified=+](#1,#3)


//*****************************************************

// extractions on terms : either the term is modified by a simple polar predicate
// or by a polar predicate carrying a semantic category : the food is expensive 
// term is food, categ is price, pola is neg.

|#1[resto,sentiments:~,not-term:~]|
   if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~,attribs:~]) & ASPECTTERM(#1) )
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="RESTAURANT",resto=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

|#1[resto,sentiments:~,not-term:~]|
   if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~,price:+])  & ASPECTTERM(#1) )
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="RESTAURANT",resto=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

//|#1[resto,sentiments:~,not-term:~]|
//   if (SENTIMENT[sentiments,!sentiments:!](#1,#2[ambience:+])  & ASPECTTERM(#1) )
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="RESTAURANT",resto=+],##OPINION-ATTRIB[lemme:"AMBIENCE",ambience=+])

|#1[resto,aspect:~,sentiments:~,not-term:~]|
   if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~,price:+]) & ASPECTTERM(#1) )
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="RESTAURANT",resto=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

// for food and drink, quality attrib is default
|#1[food,drink:~,sentiments:~,style:~,not-term:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~,attribs:~])  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

|#1[drink,sentiments:~,style:~,not-term:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~,attribs:~])  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

|#1[food,drink:~,sentiments:~,style:~,not-term:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[food]) & ASPECTTERM(#1)  )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

|#1[food,drink,sentiments:~,style:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[food])  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

|#1[food,drink:~,sentiments:~,not-term:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[price:+])  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

|#1[food,drink:~,sentiments:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[style:+])  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"STYLE",style=+])

|#1[drink,sentiments:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[price:+])  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

|#1[drink,sentiments:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[style:+])  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"STYLE",style=+])

|#1[food,drink:~,style,sentiments:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2)  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"STYLE",style=+])


|#1[drink,style,sentiments:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2) & ASPECTTERM(#1)  )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"STYLE",style=+])

// for service and ambience and location general attrib is the default
|#1[service,sentiments:~,not-term:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[attribs:~])  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="service",service=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

|#1[ambience,sentiments:~,not-term:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[attribs:~])  & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="ambience",ambience=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

|#1[locat,sentiments:~,not-term:~]|
        if (SENTIMENT[sentiments,!sentiments:!](#1,#2[attribs:~]) & ASPECTTERM(#1) )
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="location",locat=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])


if ( SENTIMENT[positive](#1,#2) &  SENTIMENT[negative](#1,#3) & ^TERM-CAT-OPINION[positive](#1,#4,#5))
   TERM-CAT-OPINION[neutral=+,positive=~](#1,#4,#5)

if ( SENTIMENT[positive](#1,#2) &  SENTIMENT[negative](#1,#3) & ^TERM-CAT-OPINION[negative](#1,#4,#5))
   TERM-CAT-OPINION[neutral=+,negative=~](#1,#4,#5)


//**** corrections

// Saul is the best restaurant : target=Saul

//if (SUBJ-N(#4[cop],#5[proper]) & NUCL[subjcompl](#4,#1[resto=+]) )
 //   TERM-CAT-OPINION(#5,##OPINION-TARGET[lemme="RESTAURANT",resto=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+]), ASPECTTERM[resto=+](#5) 

// the design of the sapce : term=design

if (MOD[post](#1[lemme:"design"],#2[lemme:"space"]) & ^TERM-CAT-OPINION[!sentiments:!](#1,#3,#4))
    TERM-CAT-OPINION(#2,#3,#4)

//*** LONG DISTANCE

//if (LINKPOST[!sentiments:!,food,style:~,price:~](#1,#2)  )
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

if (LINKPOST[positive,food,style:~,price:~](#1,#2)  & ~TERM-CAT-OPINION[positive](#1,?[food],?[quality]))
    TERM-CAT-OPINION[positive=+](#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

if (LINKPOST[negative,food,style:~,price:~](#1,#2)  & ~TERM-CAT-OPINION[negative](#1,?[food],?[quality]) )
    TERM-CAT-OPINION[negative=+](#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

if (LINKPOST[!sentiments:!,food,price](#1,#2) & ~TERM-CAT-OPINION(#1,?[food],?[price]) )
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

if (LINKPOST[!sentiments:!,food,style](#1,#2) & ~TERM-CAT-OPINION(#1,?[food],?[style]) )
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"STYLE",style=+])

if (LINKPOST[!sentiments:!,drink,style:~,price:~](#1,#2) & ~TERM-CAT-OPINION(#1,?[drink],?[quality]) )
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

if (LINKPOST[!sentiments:!,drink,price](#1,#2) & ~TERM-CAT-OPINION(#1,?[drink],?[price]) )
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

if (LINKPOST[!sentiments:!,drink,style](#1,#2) & ~TERM-CAT-OPINION(#1,?[drink],?[style]) )
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"STYLE",style=+])

if (LINKPOST[!sentiments:!,resto,price:~](#1,#2) & ~TERM-CAT-OPINION(#1,?[resto],?[general]) )
 TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="RESTAURANT",resto=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

if (LINKPOST[!sentiments:!,resto,price](#1,#2) & ~TERM-CAT-OPINION(#1,?[resto],?[price]) )
 TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="RESTAURANT",resto=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

if (LINKPOST[!sentiments:!,ambience](#1,#2) & ~TERM-CAT-OPINION(#1,?[ambience],?[general]) ) 
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="ambience",ambience=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

if (LINKPOST[!sentiments:!,service](#1,#2) & ~TERM-CAT-OPINION(#1,?[service],?[general]) ) 
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="service",service=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

if (LINKPOST[!sentiments:!,locat](#1,#2) & ~TERM-CAT-OPINION(#1,?[locat],?[general]) ) 
       TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="location",locat=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])


if (LINKPRE[!sentiments:!,food,style:~,price:~](#2,#1) & ~TERM-CAT-OPINION(#1,?[food],?[quality])  & HEAD(#3,#1) )
    TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

if (LINKPRE[!sentiments:!,food,price](#2,#1) & ~TERM-CAT-OPINION(#1,?[food],?[price]) & HEAD(#3,#1) )
    TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

if (LINKPRE[!sentiments:!,food,style](#2,#1) & ~TERM-CAT-OPINION(#1,?[food],?[style]) & HEAD(#3,#1) )
    TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"STYLE",style=+])

if (LINKPRE[!sentiments:!,drink,style:~,price:~](#2,#1) & ~TERM-CAT-OPINION(#1,?[drink],?[quality]) & HEAD(#3,#1) )
    TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])

if (LINKPRE[!sentiments:!,drink,price](#2,#1) & ~TERM-CAT-OPINION(#1,?[drink],?[price]) & HEAD(#3,#1) )
    TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

if (LINKPRE[!sentiments:!,drink,style](#2,#1) & ~TERM-CAT-OPINION(#1,?[drink],?[style]) & HEAD(#3,#1) )
    TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="drink",drink=+],##OPINION-ATTRIB[lemme:"STYLE",style=+])

if (LINKPRE[!sentiments:!,resto,price:~](#2,#1) & ~TERM-CAT-OPINION(#1,?[resto],?[general]) & HEAD(#3,#1) )
 TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="RESTAURANT",resto=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

if (LINKPRE[!sentiments:!,resto,price](#2,#1) & ~TERM-CAT-OPINION(#1,?[resto],?[price]) & HEAD(#3,#1) )
 TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="RESTAURANT",resto=+],##OPINION-ATTRIB[lemme:"PRICE",price=+])

if (LINKPRE[!sentiments:!,ambience](#2,#1) & ~TERM-CAT-OPINION(#1,?[ambience],?[general]) & HEAD(#3,#1) ) 
    TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="ambience",ambience=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

if (LINKPRE[!sentiments:!,ambience](#2,#1[terminal])   ) 
    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="ambience",ambience=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])


if (LINKPRE[!sentiments:!,service](#2,#1) & ~TERM-CAT-OPINION(#1,?[service],?[general]) & HEAD(#3,#1) ) 
    TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="service",service=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

if (LINKPRE[!sentiments:!,locat](#2,#1) & ~TERM-CAT-OPINION(#1,?[locat],?[general]) & HEAD(#3,#1) ) 
       TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="location",locat=+],##OPINION-ATTRIB[lemme:"GENERAL",general=+])

// headed links
if (LINKPRE[!sentiments:!,food,style:~,price:~](#2,#3) & ~TERM-CAT-OPINION(#1,?[food],?[quality])  )
    TERM-CAT-OPINION(#3,##OPINION-TARGET[lemme="food",food=+],##OPINION-ATTRIB[lemme:"QUALITY",quality=+])


// NEUTRAL 

if ( SENTIMENT[positive](#1,#2[price]) &  SENTIMENT[negative](#1,#3[price]) & ^TERM-CAT-OPINION[positive](#1,#4,#5))
   TERM-CAT-OPINION[neutral=+,positive=~](#1,#4,#5)

if ( SENTIMENT[positive](#1,#2[price]) &  SENTIMENT[negative](#1,#3[price]) &  ^TERM-CAT-OPINION[negative](#1,#4,#5) & ~TERM-CAT-OPINION[neutral](#1,#4,#5)) 
   TERM-CAT-OPINION[neutral=+,negative=~](#1,#4,#5)

if ( SENTIMENT[positive](#1,#2[style]) &  SENTIMENT[negative](#1,#3[style]) & ^TERM-CAT-OPINION[positive](#1,#4,#5))
   TERM-CAT-OPINION[neutral=+,positive=~](#1,#4,#5)

if ( SENTIMENT[positive](#1,#2[style]) &  SENTIMENT[negative](#1,#3[style]) &  ^TERM-CAT-OPINION[negative](#1,#4,#5) & ~TERM-CAT-OPINION[neutral](#1,#4,#5)) 
   TERM-CAT-OPINION[neutral=+,negative=~](#1,#4,#5)

if ( SENTIMENT[positive](#1,#2[attribs:~]) &  SENTIMENT[negative](#1,#3[attribs:~]) & ^TERM-CAT-OPINION[positive](#1,#4,#5))
   TERM-CAT-OPINION[neutral=+,positive=~](#1,#4,#5)

if ( SENTIMENT[positive](#1,#2[attribs:~]) &  SENTIMENT[negative](#1,#3[attribs:~]) &  ^TERM-CAT-OPINION[negative](#1,#4,#5) & ~TERM-CAT-OPINION[neutral](#1,#4,#5)) 
   TERM-CAT-OPINION[neutral=+,negative=~](#1,#4,#5)


//************OLD 
// |#1[food,drink:~,sentiments:~]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~]))
//        TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+])

// |#1[drink,sentiments:~]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~]))
//        TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drink",drink=+])

// |#1[service,sentiments:~]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~]))
//        TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="service",service=+])

// |#1[ambience,locat:~,sentiments:~]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~]))
//        TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="ambience",ambience=+])

// |#1[locat,sentiments:~]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~]))
//        TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="location",locat=+])

// |#1[price,sentiments:~]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~]))
//        TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="price",price=+])

// |#1[lemme:"place"]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[aspect:~]))
//         TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="overall",overall=+])


// // case 2

// |#1[aspect,sentiments:~]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[price]))
//         TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="price",price=+])

// |#1[aspect,sentiments:~]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[food]))
//         TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+])

// |#1[aspect,sentiments:~]|
//         if (SENTIMENT[sentiments,!sentiments:!](#1,#2[ambience]))
//         TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="ambience",ambience=+])
// // Case of it : it is tasty 

//  if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"it"],#2[food,drink:~])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"it"],#2[drink])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drinks",drink=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"it"],#2[price])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="price",price=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"it"],#2[service])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="service",service=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"it"],#2[ambience])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="ambience",ambience=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"it"],#2[aspect:~])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="overall",overall=+])
// // this

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"this"],#2[food,drink:~])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="food",food=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"this"],#2[drink])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="drinks",drink=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"this"],#2[price])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="price",price=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"this"],#2[service])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="service",service=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"this"],#2[ambience])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="ambience",ambience=+])

// if (SENTIMENT[sentiments,!sentiments:!](#1[lemme:"this"],#2[aspect:~])) 
//    TERM-CAT-OPINION(#1,##OPINION-TARGET[lemme="overall",overall=+])


// // old extractions

// |#3[service,sentiments]| 
//               if (SENTIMENT[sentiments,!sentiments:!](#3))
//               OPINION-ON-ASPECT-TERM(#3)

// |#3[gen-term]|
//         if (SENTIMENT[!sentiments:!,positive](#3,#1))
//         OPINION-ON-ASPECT-TERM(#3)
// |#3[gen-term]|
//         if (SENTIMENT[!sentiments:!,negative](#3,#1))
//         OPINION-ON-ASPECT-TERM(#3)

// //** ajout drinks 

// if ( DRINK(#3) & SENTIMENT[!sentiments:!,positive](#3,#1))
//    OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="drinks",drink=+]),OPINION-ON-ASPECT-TERM(#3)

// if ( DRINK(#3) & SENTIMENT[!sentiments:!,negative](#3,#1) ) 
//    OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="drinks",drink=+]),OPINION-ON-ASPECT-TERM(#3)

// // ***

// |#3[food,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,positive](#3,#1) & ~DRINK(#3) )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="food",food=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[service,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,positive](#3,#1)  )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="service",service=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[ambience,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,positive](#3,#1))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="ambience",ambience=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[price,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,positive](#3,#1) )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[price,partpas]|
//       if (SENTIMENT[!sentiments:!,positive](#3,#1) )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[food,sentiments:~]|
//       if ( (SENTIMENT[!sentiments:!,negative](#3,#1) | SENTIMENT[!sentiments:!,negative](#1,#3) ) & ~DRINK(#3) )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="food",food=+]),OPINION-ON-ASPECT-TERM(#3)

// //|#3[food,sentiments:~]|
//   //    if ( (SENTIMENT[!sentiments:!,negative](#3,#1) | SENTIMENT[!sentiments:!,negative](#1,#3) ) & DRINK(#3) )
//   //     OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="drinks",drink=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[service,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,negative](#3,#1))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="service",service=+]),OPINION-ON-ASPECT-TERM(#3)


// |#3[ambience,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,negative](#3,#1))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="ambience",ambience=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[price,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,negative](#3,#1))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+]),OPINION-ON-ASPECT-TERM(#3)
// |#3[price,partpas]|
//       if (SENTIMENT[!sentiments:!,negative](#3,#1))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[food,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,negative](#3) & ~DRINK(#3) )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="food",food=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[food,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,negative](#3) & DRINK(#3) )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="drinks",drink=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[service,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,negative](#3))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="service",service=+]),OPINION-ON-ASPECT-TERM(#3)
// |#3[ambience,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,negative](#3))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="ambience",ambience=+]),OPINION-ON-ASPECT-TERM(#3)
// |#3[price,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,negative](#3))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+]),OPINION-ON-ASPECT-TERM(#3)


// // new neutral 
// |#3[food,sentiments:~]|
//       if ( (SENTIMENT[!sentiments:!,neutral](#3,#1) | SENTIMENT[!sentiments:!,neutral](#1,#3) ) & ~DRINK(#3) )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="food",food=+]),OPINION-ON-ASPECT-TERM(#3)

// //|#3[food,sentiments:~]|
//   //    if ( (SENTIMENT[!sentiments:!,neutral](#3,#1) | SENTIMENT[!sentiments:!,neutral](#1,#3) ) & DRINK(#3) )
//   //     OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="drinks",drink=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[service,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,neutral](#3,#1))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="service",service=+]),OPINION-ON-ASPECT-TERM(#3)


// |#3[ambience,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,neutral](#3,#1))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="ambience",ambience=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[price,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,neutral](#3,#1))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+]),OPINION-ON-ASPECT-TERM(#3)
// |#3[price,partpas]|
//       if (SENTIMENT[!sentiments:!,neutral](#3,#1))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[food,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,neutral](#3) & ~DRINK(#3) )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="food",food=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[food,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,neutral](#3) & DRINK(#3) )
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="drinks",drink=+]),OPINION-ON-ASPECT-TERM(#3)

// |#3[service,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,neutral](#3))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="service",service=+]),OPINION-ON-ASPECT-TERM(#3)
// |#3[ambience,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,neutral](#3))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="ambience",ambience=+]),OPINION-ON-ASPECT-TERM(#3)
// |#3[price,sentiments:~]|
//       if (SENTIMENT[!sentiments:!,neutral](#3))
//        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+]),OPINION-ON-ASPECT-TERM(#3)
// // marquer les elements vus pour pouvoir marquer les neutres
// |#3{?+[marque=+]}|
//         if ( OPINION-ON-ASPECT-TERM(#3) )
//         ~
// // TOOLS 

// if ( ( ATTRIB(#1[pron:~],#2[food,sentiments]) | MOD(#1[pron:~],#2[food,sentiments]))  & ~FOOD(#1) )
//      MODFOOD(#2,#1)
    
// // neutral 
// |#3[noun,sentiments:~]|
//         if (~SENTIMENT(#3,#1)  & ~SENTIMENT(#3)  & ~SENTIMENT(#1,#3) &  ( FOOD(#3) |AMBIENCE(#3) | SERVICE(#3) | PRICE(#3) |DRINK(#3) ) )
//         OPINION-ON-ASPECT-TERM[neutral=+](#3)

// |#3[gen-term]|
//          if (~SENTIMENT[positive](#3,#1) & ~SENTIMENT[negative](#3,#2)  )
//         OPINION-ON-ASPECT-TERM[neutral=+](#3)


// //*************** ONLY ASPECT CATEGORY: NO EXPLICIT TARGET
// //it is affordable:
// |#3[price]|
//         if (SENTIMENT[!sentiments:!](#3,#1))
//          OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+])

// |#1[price]|
//         if (SENTIMENT[!sentiments:!](#3,#1))
//          OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+])

// |#1[price]|
//         if (SENTIMENT[!sentiments:!](#1))
//          OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="price",price=+])

// // it is tasty
// |#1[food]|
//         if (SENTIMENT[!sentiments:!](#3,#1))
//          OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="food",food=+])

// |#1[food]|
//         if (SENTIMENT[!sentiments:!](#1))
//          OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="food",food=+])

// // they serve quickly

// |#1[service]|
//         if (SENTIMENT[!sentiments:!](#3,#1))
//          OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="service",service=+])

// |#1[service]|
//         if (SENTIMENT[!sentiments:!](#1))
//          OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="service",service=+])


// |#1[ambience]|
//         if (SENTIMENT[!sentiments:!](#3,#1))
//          OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="ambience",ambience=+])

// |#1[ambience]|
//         if (SENTIMENT[!sentiments:!](#1))
//          OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="ambience",ambience=+])


// // CONFLICTS ON THE ASPECT CATEGORIES 

// if ( ^OPINION-ON-ASPECT-CATEGORY[negative](#2[lemme:"ambience"]) & OPINION-ON-ASPECT-CATEGORY$1[positive](#1[lemme:"ambience"]) )
//             OPINION-ON-ASPECT-CATEGORY[conflict=+,negative=~](#1), ~$1

//   if ( ^OPINION-ON-ASPECT-CATEGORY[positive](#1[lemme:"service"]) & OPINION-ON-ASPECT-CATEGORY$2[negative](#2[lemme:"service"]) )
//              OPINION-ON-ASPECT-CATEGORY[conflict=+,positive=~](#1), ~$2
   
// if ( ^OPINION-ON-ASPECT-CATEGORY[positive](#1[lemme:"price"]) & OPINION-ON-ASPECT-CATEGORY$2[negative](#2[lemme:"price"]) )
//              OPINION-ON-ASPECT-CATEGORY[conflict=+,positive=~](#1), ~$2
 
   
// if ( ^OPINION-ON-ASPECT-CATEGORY[positive](#1[lemme:"food"]) & OPINION-ON-ASPECT-CATEGORY$2[negative](#2[lemme:"food"]) )
//              OPINION-ON-ASPECT-CATEGORY[conflict=+,positive=~](#1), ~$2

// if ( OPINION-ON-ASPECT-CATEGORY[conflict](#1[lemme:"ambience"]) & ^OPINION-ON-ASPECT-CATEGORY[negative](#2[lemme:"ambience"]) )
//    ~
// if ( OPINION-ON-ASPECT-CATEGORY[conflict](#1[lemme:"ambience"]) & ^OPINION-ON-ASPECT-CATEGORY[positive](#2[lemme:"ambience"]) )
//    ~
// if ( OPINION-ON-ASPECT-CATEGORY[conflict](#1[lemme:"food"]) & ^OPINION-ON-ASPECT-CATEGORY[positive](#2[lemme:"food"]) )
//    ~
// if ( OPINION-ON-ASPECT-CATEGORY[conflict](#1[lemme:"food"]) & ^OPINION-ON-ASPECT-CATEGORY[negative](#2[lemme:"food"]) )
//    ~

// // neutral

// //|top{?*,?[lemme:~":",last]}| 
// //if ( ~SENTIMENT[positive](?,?) &  ~SENTIMENT[negative](?,?)  &  ~SENTIMENT[positive](?) & ~SENTIMENT[negative](?) & ~FOOD(?) & ~SERVICE(?) & ~AMBIENCE(?) & ~PRICE(?))
// //   OPINION-ON-ASPECT-CATEGORY[neutral=+](##OPINION-TARGET[lemme="anecdotes%/miscellaneous"])
// //
// //
// //if ( OPINION-ON-ASPECT-TERM$1[neutral](?[food]) & 
// //   ~OPINION-ON-ASPECT-TERM$2[negative](?[aspect]) &
// //   ~OPINION-ON-ASPECT-TERM$2[conflict](?[aspect]) & 
// //   ~OPINION-ON-ASPECT-TERM$3[positive](?[aspect]) &
// //   ~OPINION-ON-ASPECT-CATEGORY[positive](?[lemme:"food"]) &
// //   ~OPINION-ON-ASPECT-CATEGORY[negative](?[lemme:"food"])
// // )
// // OPINION-ON-ASPECT-CATEGORY[neutral=+](##OPINION-TARGET[lemme="food",food=+])
// //
// //if ( OPINION-ON-ASPECT-TERM$1[neutral](?[service]) & 
// //   ~OPINION-ON-ASPECT-TERM$2[negative](?[aspect]) &
// //   ~OPINION-ON-ASPECT-TERM$2[conflict](?[aspect]) & 
// //   ~OPINION-ON-ASPECT-TERM$3[positive](?[aspect]) &
// //   ~OPINION-ON-ASPECT-CATEGORY[positive](?[lemme:"service"]) &
// //   ~OPINION-ON-ASPECT-CATEGORY[negative](?[lemme:"service"])
// // )
// // OPINION-ON-ASPECT-CATEGORY[neutral=+](##OPINION-TARGET[lemme="service",service=+])
// //
// //if ( OPINION-ON-ASPECT-TERM$1[neutral](?[price]) & 
// //   ~OPINION-ON-ASPECT-TERM$2[negative](?[aspect]) &
// //   ~OPINION-ON-ASPECT-TERM$2[conflict](?[aspect]) & 
// //   ~OPINION-ON-ASPECT-TERM$3[positive](?[aspect]) &
// //   ~OPINION-ON-ASPECT-CATEGORY[positive](?[lemme:"price"]) &
// //   ~OPINION-ON-ASPECT-CATEGORY[negative](?[lemme:"price"])
// // )
// // OPINION-ON-ASPECT-CATEGORY[neutral=+](##OPINION-TARGET[lemme="price",price=+])
// //
// //if ( OPINION-ON-ASPECT-TERM$1[neutral](?[ambience]) & 
// //   ~OPINION-ON-ASPECT-TERM$2[negative](?[aspect]) &
// //   ~OPINION-ON-ASPECT-TERM$2[conflict](?[aspect]) & 
// //   ~OPINION-ON-ASPECT-TERM$3[positive](?[aspect]) &
// //   ~OPINION-ON-ASPECT-CATEGORY[positive](?[lemme:"ambience"]) &
// //   ~OPINION-ON-ASPECT-CATEGORY[negative](?[lemme:"ambience"])
// // )
// // OPINION-ON-ASPECT-CATEGORY[neutral=+](##OPINION-TARGET[lemme="ambience",ambience=+])
// //
// //
// //|#3[price:~,food:~,service:~,ambience:~]|
// //        if (SENTIMENT[!sentiments:!](#3,#1) & ~SENTIMENT(#4[aspect],#6) &  ~SENTIMENT(#5,#2[aspect]) & ~OPINION-ON-ASPECT-CATEGORY(#8[aspect])  )
// //        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="anecdotes%/miscellaneous"])
// //
// //|#3[price:~,food:~,service:~,ambience:~,not-in-misc:~]|
// //        if (SENTIMENT[!sentiments:!](#3,#1[price:~,food:~,service:~,ambience:~]) & ~SENTIMENT(#4[aspect],#6) &  ~SENTIMENT(#5,#2[aspect]) & ~OPINION-ON-ASPECT-CATEGORY(#8[aspect]) )
// //        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="anecdotes%/miscellaneous"])
// //
// //
// //|#3[price:~,food:~,service:~,ambience:~,not-in-misc:~,emoticons:~]|
// //        if (SENTIMENT[!sentiments:!](#3) & ~SENTIMENT(#5[aspect],#1) &  ~SENTIMENT(#5,#2[aspect])  & ~OPINION-ON-ASPECT-CATEGORY(?[aspect]))
// //        OPINION-ON-ASPECT-CATEGORY(##OPINION-TARGET[lemme="anecdotes%/miscellaneous"])


// // deletion of duplicates couples category + polarity

// if ( OPINION-ON-ASPECT-CATEGORY[positive](#1[lemme:"food"]) & ^OPINION-ON-ASPECT-CATEGORY$2[positive](#2[lemme:"food"]) )
//               ~$2
// if ( OPINION-ON-ASPECT-CATEGORY[positive](#1[lemme:"service"]) & ^OPINION-ON-ASPECT-CATEGORY$2[positive](#2[lemme:"service"]) )
//               ~$2

// if ( OPINION-ON-ASPECT-CATEGORY[positive](#1[lemme:"ambience"]) & ^OPINION-ON-ASPECT-CATEGORY$2[positive](#2[lemme:"ambience"]) )
//               ~$2
// if ( OPINION-ON-ASPECT-CATEGORY[positive](#1[lemme:"price"]) & ^OPINION-ON-ASPECT-CATEGORY$2[positive](#2[lemme:"price"]) )
//               ~$2

// if ( OPINION-ON-ASPECT-CATEGORY[negative](#1[lemme:"food"]) & ^OPINION-ON-ASPECT-CATEGORY$2[negative](#2[lemme:"food"]) )
//               ~$2
// if ( OPINION-ON-ASPECT-CATEGORY[negative](#1[lemme:"service"]) & ^OPINION-ON-ASPECT-CATEGORY$2[negative](#2[lemme:"service"]) )
//               ~$2

// if ( OPINION-ON-ASPECT-CATEGORY[negative](#1[lemme:"ambience"]) & ^OPINION-ON-ASPECT-CATEGORY$2[negative](#2[lemme:"ambience"]) )
//               ~$2
// if ( OPINION-ON-ASPECT-CATEGORY[negative](#1[lemme:"price"]) & ^OPINION-ON-ASPECT-CATEGORY$2[negative](#2[lemme:"price"]) )
//               ~$2

// if ( OPINION-ON-ASPECT-CATEGORY[positive](#1[lemme:"anecdotes%/miscellaneous"]) & ^OPINION-ON-ASPECT-CATEGORY$2[positive](#2[lemme:"anecdotes%/miscellaneous"]) )
//    ~$2
// if ( OPINION-ON-ASPECT-CATEGORY[negative](#1[lemme:"anecdotes%/miscellaneous"]) & ^OPINION-ON-ASPECT-CATEGORY$2[negative](#2[lemme:"anecdotes%/miscellaneous"]) )
//    ~$2

// if ( ^OPINION-ON-ASPECT-CATEGORY[positive](#1[lemme:"anecdotes%/miscellaneous"]) & OPINION-ON-ASPECT-CATEGORY$2[negative](#2[lemme:"anecdotes%/miscellaneous"]) )
//              OPINION-ON-ASPECT-CATEGORY[conflict=+,positive=~](#1), ~$2

// // conflict on terms: need to be done at the end

// //if ( ^OPINION-ON-ASPECT-TERM[positive](#1) & OPINION-ON-ASPECT-TERM$2[negative](#1) )
//   //          OPINION-ON-ASPECT-TERM[conflict=+,positive=~](#1), ~$2

// // 
// if (OBJ-N(#1,#2[conflict,aspect]))
//    OPINION-ON-ASPECT-TERM[conflict=+](#2)

// // TEST HEURISTIC

// //if (  SENTIMENT[positive](#1,#2) & ~SENTIMENT[negative](?,?)  & ~SENTIMENT[negative](?) & ^OPINION-ON-ASPECT-TERM[neutral](#3) & (#1 < #3) & (#2 < #3) )
//   //                 OPINION-ON-ASPECT-TERM[positive=+,neutral=~](#3)

//  //if ( SENTIMENT[negative](#1,#2) & ~SENTIMENT[positive](?,?)  & ~SENTIMENT[positive](?) & ^OPINION-ON-ASPECT-TERM[neutral](#3) & (#1 < #3) & (#2 < #3) )
//  // OPINION-ON-ASPECT-TERM[negative=+,neutral=~](#3)

// //if ( SENTIMENT[positive](#1) & ~SENTIMENT[negative](?,?)  & ~SENTIMENT[negative](?) & ^OPINION-ON-ASPECT-TERM[neutral](#3) & (#1 < #3)  )
// //     OPINION-ON-ASPECT-TERM[positive=+,neutral=~](#3)

// //if ( SENTIMENT[negative](#1) & ~SENTIMENT[positive](?,?)  & ~SENTIMENT[positive](?) & ^OPINION-ON-ASPECT-TERM[neutral](#3) & (#1 < #3)  )
// //   OPINION-ON-ASPECT-TERM[negative=+,neutral=~](#3)

// if ( ^OPINION-ON-ASPECT-TERM[positive](#1) & OPINION-ON-ASPECT-TERM$2[negative](#1) )
//         OPINION-ON-ASPECT-TERM[conflict=+,positive=~](#1), ~$2


// //cleaning 

// |#1{?*,#2,?*}|
//         if (^PERSON(#1))
//         ~
// |#1{?*,#2,?*}|
//         if (^LOCORG(#1))
//         ~


// if (COORD(#1,#2) & COORD(#1,#3) & FOOD(#2) & ~FOOD(#3))
//    POTFOOD(#3,#2) 


//erase

// |SC#1|
//         if (^FOOD(#1) | ^SERVICE(#1) | ^AMBIENCE(#1) | ^RESTO(#1) | ^DRINK(#1) | ^LOCATION(#1)  )
//         ~
// |NP#1|
//         if (^FOOD(#1)| ^SERVICE(#1) | ^AMBIENCE(#1) | ^RESTO(#1) | ^DRINK(#1)  | ^LOCATION(#1) )
//         ~
